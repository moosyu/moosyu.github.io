---
// TODO: FIX SORTING BY TIME
import BaseLayout from "../../layouts/BaseLayout.astro";
import RamblingDate from "../../components/RamblingDate.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const ramblings = (await getCollection("ramblings")).reverse();

  const years = Array.from(new Set(ramblings.map((post) => post.id.slice(0, 4))));

  return years.map((year) => ({
    params: { year },
    props: {
      ramblings: ramblings.filter((post) =>
        post.id.startsWith(year)
      ),
    },
  }));
}

const { year } = Astro.params;
const { ramblings } = Astro.props;
---
<style>
    .ramblings-container {
        border-bottom: 1px hsla(0, 0%, 100%, .12) solid;
        font-size: 16px;
    }
</style>
<BaseLayout title={`ramblings ${year}`}>
    <div class="background-div bottom-div">
        <div style="display: flex; flex-direction: row; align-items: center; justify-content: space-between;">
            <p style="text-align: left;">Ramblings list version {year}!! (Same entries as the calendar just in a different view.)</p>
            <h3 style="text-align: right;"><a style="text-decoration: none;" href="javascript: document.body.scrollIntoView(false);">To bottom ↓</a></h3>
        </div>
            {ramblings.map((rambling) => {
                const ramblingsSlug = rambling.slug.split("-");
                return (
                <div class="ramblings-container">
                    <RamblingDate ramblingEntry={rambling} />
                    <p><a href={`/ramblings/${ramblingsSlug[0]}/${ramblingsSlug[1]}/${ramblingsSlug[2]}`}>{rambling.data.title ?? "Untitled entry"}</a></p>
                </div>
                )
            })}
        <h3 style="text-align:right;"><a style="text-decoration: none;" href="#top">To top ↑</a></h3>
    </div>
</BaseLayout>